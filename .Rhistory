Word.of.mouth.discussion.with.others == 1 ~ "Word of mouth/discussion with others"))
#64
resp.split_64 <- strsplit(sleephygiene$Q64, ",")
lev <- unique(unlist(resp.split_64))
sleephygiene<- with(sleephygiene, data.frame(sleephygiene, t(sapply(resp.split_64, function(x) table(factor(x, levels=lev))))))
sleephygiene <- sleephygiene %>%
mutate(Q64_whichtechniquedidyoutry = case_when(
X.MoveMore == 1 ~ "Movemore",
X.Breathe== 1 ~ "Breathe",
X.PowerDown == 1 ~ "Powerdown",
None.of.the.above == 1 ~ "None of the above"))
#70
resp.split_70 <- strsplit(sleephygiene$Q70, ",")
lev <- unique(unlist(resp.split_70))
sleephygiene<- with(sleephygiene, data.frame(sleephygiene, t(sapply(resp.split_70, function(x) table(factor(x, levels=lev))))))
sleephygiene <- sleephygiene %>%
mutate(Q70_timingoftextsinconvenient = case_when(
#Messages.were.too.frequent == 1 ~ "Messages were too frequent",
Messages.were.too.infrequent== 1 ~ "Messages were too infrequent",
Received.message.too.early.in.the.day == 1 ~ "Received message too early in the day",
#Received.message.too.late.in.the.day == 1 ~ "Received message too late in the day",
Other..please.explain.below. == 1 ~ "Other (please explain below)"))
#71
resp.split_71 <- strsplit(sleephygiene$Q71, ",")
lev <- unique(unlist(resp.split_71))
sleephygiene<- with(sleephygiene, data.frame(sleephygiene, t(sapply(resp.split_71, function(x) table(factor(x, levels=lev))))))
sleephygiene <- sleephygiene %>%
mutate(Q71_whichchannelmosteducational = case_when(
Text == 1 ~ "Text",
Instagram == 1 ~ "Instagram"))
#Discussion.with.others.about.the.campaign == 1 ~ "Discussion with others about the campaign",
#None.of.the.above.1 == 1 ~ "None of the above"))
#72 - look into
#Q79
resp.split_79 <- strsplit(sleephygiene$Q79, ",")
lev <- unique(unlist(resp.split_79))
sleephygiene<- with(sleephygiene, data.frame(sleephygiene, t(sapply(resp.split_79, function(x) table(factor(x, levels=lev))))))
sleephygiene <- sleephygiene %>%
mutate(Q79_moresuccessfuloutcomsuggestions = case_when(
There.was.an.in.person.on.campus.component.to.the.campaign == 1 ~ "There was an in-person/on-campus component to the campaign",
The.campaign.was.longer == 1 ~ "The campaign was longer",
I.had.more.flexibility.in.my.day == 1 ~ "I had more flexibility in my day",
There.were.subject.matter.experts.checking.in.with.me.one.on.one == 1 ~ "There were subject matter experts checking in with me one-on-one"))
#Other == 1 ~ "Reduce irregular or long daytime naps",
#Q73
resp.split_73 <- strsplit(sleephygiene$Q73, ",")
lev <- unique(unlist(resp.split_73))
sleephygiene<- with(sleephygiene, data.frame(sleephygiene, t(sapply(resp.split_73, function(x) table(factor(x, levels=lev))))))
sleephygiene <- sleephygiene %>%
mutate(Q73_hearabouthow = case_when(
Instagram.1 == 1 ~ "Instagram",
JHSPH.Activities.email == 1 ~ "JHSPH Activities email",
#Class.announcement == 1 ~ "Class announcement",
Word.of.mouth.discussion.with.others.1 == 1 ~ "Word of mouth/discussion with others"))
#Other == 1 ~ "Reduce irregular or long daytime naps",
# Chunk 6
library(plotly)
workdayssleep <- sleephygiene %>% ggplot( aes(x=Q10_hoursofsleeplast5workdays)) +
geom_histogram( binwidth=1, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Hours of sleep last five workdays") +
theme(
plot.title = element_text(size=32)
) +
labs(x="Number of hours of sleep in the past five workdays", y="Number of participants")
ggplotly(workdayssleep)
#Plot for weekend
weekend <- sleephygiene %>% ggplot( aes(x=Q10_hoursofsleeppastweekend)) +
geom_histogram( binwidth=1, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Hours of sleep last weekend") +
theme(
plot.title = element_text(size=32)
) +
labs(x="Number of hours of sleep in the past weekend", y="Number of participants")
ggplotly(weekend)
# Chunk 7: Applying labels
#Tab 1
sleephygiene$Q9_howoftensleepypastmonth <- factor(sleephygiene$Q9_howoftensleepypastmonth, levels = c("Never", "Rarely", "Sometimes", "Very often", "Always"))
sleephygiene$Q61_howoftensleepypasttwoweeks <- factor(sleephygiene$Q61_howoftensleepypasttwoweeks, levels = c("Never", "Rarely", "Sometimes", "Very often", "Always"))
sleephygiene$Q89_ratesleepquality_notawareofcampaign <- factor(sleephygiene$Q89_ratesleepquality_notawareofcampaign, levels = c("Poor", "Fair", "Good", "Excellent"))
sleephygiene$Q75_moving <- factor(sleephygiene$Q75_moving, levels = c("Extremely unhelpful", "Somewhat unhelpful", "Neither helpful nor unhelpful", "Somewhat helpful", "Extremely helpful"))
sleephygiene$Q75_breathing <- factor(sleephygiene$Q75_breathing, levels = c("Extremely unhelpful", "Somewhat unhelpful", "Neither helpful nor unhelpful", "Somewhat helpful", "Extremely helpful"))
sleephygiene$Q75_powerdown <- factor(sleephygiene$Q75_powerdown, levels = c("Extremely unhelpful", "Somewhat unhelpful", "Neither helpful nor unhelpful", "Somewhat helpful", "Extremely helpful"))
sleephygiene$Q87_idealtime <- factor(sleephygiene$Q87_idealtime, levels = c("Early morning (6:00 am - 9:00 am)", "Late morning (9:01 am - 12:00 pm)", "Early afternoon (12:01 pm - 3:00 pm)", "Late afternoon (3:01 pm - 6:00 pm)", "Early evening (6:01 pm - 9:00 pm)", "Late evening (9:01 pm - 12:00 am)", "Other (please specify)"))
sleephygiene$Q59_canmaintainhealthysleephabits <- factor(sleephygiene$Q59_canmaintainhealthysleephabits, levels = c("Not at all confident", "Somewhat confident", "Extremely confident"))
sleephygiene$Q59_cancutoutscreen <- factor(sleephygiene$Q59_cancutoutscreen, levels = c("Not at all confident", "Somewhat confident", "Extremely confident"))
sleephygiene$Q59_canexercise <- factor(sleephygiene$Q59_canexercise, levels = c("Not at all confident", "Somewhat confident", "Extremely confident"))
sleephygiene$Q59_canparticipateinbreathing <- factor(sleephygiene$Q59_canparticipateinbreathing, levels = c("Not at all confident", "Somewhat confident", "Extremely confident"))
sleephygiene$Q44_goodnightsleepisimportant <- factor(sleephygiene$Q44_goodnightsleepisimportant, levels = c("Strongly disagree", "Somewhat disagree", "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
sleephygiene$Q44_mentalclarity <- factor(sleephygiene$Q44_mentalclarity, levels = c("Strongly disagree", "Somewhat disagree", "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
sleephygiene$Q44_feelpositive <- factor(sleephygiene$Q44_feelpositive, levels = c("Strongly disagree", "Somewhat disagree", "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
sleephygiene$Q44_cuttingoutscreenleadstobettersleep <- factor(sleephygiene$Q44_cuttingoutscreenleadstobettersleep, levels = c("Strongly disagree", "Somewhat disagree", "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
sleephygiene$Q44_exercisingleadstobettersleep <- factor(sleephygiene$Q44_exercisingleadstobettersleep, levels = c("Strongly disagree", "Somewhat disagree", "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
sleephygiene$Q44_breathingexercisesleadstobettersleep <- factor(sleephygiene$Q44_breathingexercisesleadstobettersleep, levels = c("Strongly disagree", "Somewhat disagree", "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
sleephygiene$Q44_iwillstopscreens <- factor(sleephygiene$Q44_iwillstopscreens, levels = c("Strongly disagree", "Somewhat disagree", "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
sleephygiene$Q44_iwillexercise <- factor(sleephygiene$Q44_iwillexercise, levels = c("Strongly disagree", "Somewhat disagree", "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
sleephygiene$Q44_iwillbreathe <- factor(sleephygiene$Q44_iwillbreathe, levels = c("Strongly disagree", "Somewhat disagree", "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
library(expss)
sleephygiene = apply_labels(sleephygiene,
Q3_role = "What is your role at Bloomberg",
Q4_gender = "Which best describes your gender identity?",
Q2_program = "What is your current program at Bloomberg?",
Q5_age = "How old are you?",
Q6_numberinhousehold = "How many people live in your household, including yourself?",
Q37_employed = "If you are a student at Bloomberg, are you currently employed outside of your education program?",
Q92_notSPHemployed = "Are you currently employed?",
Q93_worksetting = "Which of the following best describes your current work setting?",
Q94_dayornight = "Do you work day or night shifts?",
Q38_worksetting = "Which of the following best describes your current work setting?",
Q39_dayornight = "Do you work day or night shifts?",
Q10_hoursofsleeplast5workdays = "On average, how many hours of sleep did you get per night during the following periods of time: during the last 5 workdays?",
Q10_hoursofsleeppastweekend = "On average, how many hours of sleep did you get per night during the following periods of time: during the past weekend?",
Q9_howoftensleepypastmonth = "How often did you feel sleepy during the day in the past month?",
Q61_howoftensleepypasttwoweeks = "How often did you feel sleepy during the day during the past 2 weeks?",
Q84_awareofhowtoimprovesleepquality = "Do you know any ways a person can improve their sleep quality?",
Q85_waystoimprovesleepquality = "What are some of the ways to improve sleep quality that you know?",
Q81_seenorheardfromGNbloombergcampaign = "In the last two-three weeks have you heard, seen, or received any information from the #GoodnightBloomberg campaign led by JHSPH students promoting better sleep?",
Q63_recalltoolsfreetect = "Can you recall any specific tools, techniques, or resources from the campaign? Please describe below.",
Q96_picture1 = "Were these materials were utilized in our #GoodnightBloomberg campaign? Picture 1",
Q96_picture2 = "Were these materials were utilized in our #GoodnightBloomberg campaign? Picture 2",
Q96_picture3 = "Were these materials were utilized in our #GoodnightBloomberg campaign? Picture 3",
Q96_picture4 = "Were these materials were utilized in our #GoodnightBloomberg campaign? Picture 4",
Q96_picture5 = "Were these materials were utilized in our #GoodnightBloomberg campaign? Picture 5",
Q96_picture6 = "Were these materials were utilized in our #GoodnightBloomberg campaign? Picture 6",
Q96_picture7 = "Were these materials were utilized in our #GoodnightBloomberg campaign? Picture 7",
Q96_picture8 = "Were these materials were utilized in our #GoodnightBloomberg campaign? Picture 8",
Q95_talkedtoanyone = "Have you talked to anyone about the #GoodnightBloomberg campaign?",
Q83_talkedtowho = "Please indicate with whom you talked about #GoodnightBloomberg (check all that apply).",
Q82_knowanyonewhoengaged = "Do you know anyone who engaged in any way with the #GoodnightBloomberg campaign about promoting better sleep?",
Q69_didyouengagewiththecampaign = "Did you engage in any way with the #GoodnightBloomberg campaign led by JHSPH students during the past 2 weeks?",
Q62_howdidyouengage = "Please select which of the following parts of the #GoodnightBloomberg campaign you engaged in:",
Q64_whichtechniquedidyoutry = "Which of the following techniques did you try at least once in the last 2 weeks (choose all that apply)?",
Q90_areyouhappywithyoursleepquality_awareofcampaign = "Are you happy with your sleep quality overall currently?",
Q91_areyouhappywithyoursleepquality_notawareofcampaign = "Are you happy with your sleep quality overall currently?",
Q89_ratesleepquality_notawareofcampaign = "Please rate your sleep quality from the following options: In the last two weeks? (on average)",
Q67_move30minutes =  "In the last two weeks, how many days did you participate in the following techniques? Move 30 minutes total per day",
Q67_breathing = "In the last two weeks, how many days did you participate in the following techniques? Use a breathing exercise",
Q67_powerdown = "In the last two weeks, how many days did you participate in the following techniques? Power down your screens (i.e. cell phone, tablet, computer, TV) 1 hour before bed",
Q75_moving = "How helpful did you find the following activities for getting better quality sleep in the past 2 weeks? Moving 30 minutes total per day",
Q75_breathing = "How helpful did you find the following activities for getting better quality sleep in the past 2 weeks? Using a breathing exercise",
Q75_powerdown = "How helpful did you find the following activities for getting better quality sleep in the past 2 weeks? Powering down your screens (i.e. cell phone, tablet, computer, TV) 1 hour before bed",
Q68_timing = "Was the timing of the texts/posts convenient for you to adopt the recommended activity? ",
Q70_timingoftextsinconvenient = "Please provide information below about why the timing of the texts/posts was inconvenient?",
Q87_idealtime = "What would have been the ideal time to receive the message (EST/EDT)?",
Q71_whichchannelmosteducational = "Which channel did you find the most educational?",
Q79_moresuccessfuloutcomsuggestions = "I think I would have had a more successful outcome (e.g. better sleep quality) if (choose all that may apply):",
Q74_rafflemotivating = "Did you find the raffles motivating for participation in the #GoodnightBloomberg campaign?",
Q73_hearabouthow = "How did you hear about the #GoodnightBloomberg campaign?",
Q59_canmaintainhealthysleephabits = "Please tell us how confident you feel practicing the following behaviors in order to get better sleep: I can maintain healthy sleep habits.",
Q59_cancutoutscreen = "Please tell us how confident you feel practicing the following behaviors in order to get better sleep: I can cut out screen use 1 hour before bed.",
Q59_canexercise = "Please tell us how confident you feel practicing the following behaviors in order to get better sleep: I can exercise for 30 minutes total each day.",
Q59_canparticipateinbreathing = "Please tell us how confident you feel practicing the following behaviors in order to get better sleep: I can participate in a breathing exercise during the day or before bed.",
Q44_goodnightsleepisimportant = "Please rate your agreement with the following statements: Getting a good night's sleep is important to me.",
Q44_mentalclarity = "Please rate your agreement with the following statements: Having a regular sleep routine improves mental clarity/sharpness.",
Q44_feelpositive = "Please rate your agreement with the following statements: I feel positive about the quality of my sleep.",
Q44_cuttingoutscreenleadstobettersleep = "Please rate your agreement with the following statements: I think cutting out screen use 1 hour before bed leads to better sleep.",
Q44_exercisingleadstobettersleep = "Please rate your agreement with the following statements: I think exercising regularly leads to better sleep.",
Q44_breathingexercisesleadstobettersleep = "Please rate your agreement with the following statements: I think participating in breathing exercises during the day or before bed leads to better sleep.",
Q44_iwillstopscreens = "Please rate your agreement with the following statements: In the next two weeks, I will stop using screens 1 hour before bed for better sleep.",
Q44_iwillexercise = "Please rate your agreement with the following statements: In the next two weeks, I will exercise for at least 30 minutes total each day for better sleep.",
Q44_iwillbreathe = "Please rate your agreement with the following statements: In the next two weeks, I will do a daily breathing exercise for better sleep.",
Q52_additionalcomments = "Please share any additional comments or feedback you have about the #GoodnightBloomberg sleep campaign below."
)
# Chunk 8: Table 1
attach(sleephygiene)
tab1 <- tableby(~ Q3_role +
Q4_gender +
Q5_age +
Q6_numberinhousehold +
Q37_employed +
Q10_hoursofsleeplast5workdays +
Q10_hoursofsleeppastweekend +
Q9_howoftensleepypastmonth +
Q61_howoftensleepypasttwoweeks +
Q84_awareofhowtoimprovesleepquality +
Q81_seenorheardfromGNbloombergcampaign +
#Q63_recalltoolsfreetect +
Q96_picture1 +
Q96_picture2 +
Q96_picture3 +
Q96_picture4 +
Q96_picture5 +
Q96_picture6 +
Q96_picture7 +
Q96_picture8 +
Q95_talkedtoanyone +
Q82_knowanyonewhoengaged +
Q69_didyouengagewiththecampaign +
Q67_move30minutes +
Q67_breathing +
Q67_powerdown +
Q68_timing +
Q79_moresuccessfuloutcomsuggestions +
Q59_canmaintainhealthysleephabits +
Q59_cancutoutscreen +
Q59_canexercise +
Q59_canparticipateinbreathing +
Q44_goodnightsleepisimportant +
Q44_mentalclarity +
Q44_feelpositive +
Q44_cuttingoutscreenleadstobettersleep +
Q44_exercisingleadstobettersleep +
Q44_breathingexercisesleadstobettersleep +
Q44_iwillstopscreens +
Q44_iwillexercise +
Q44_iwillbreathe,
data=sleephygiene, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab1, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#If student
student <- sleephygiene %>% filter(Q3_role %in% c("Part-time student", "Full-time student"))
tab2 <- tableby(~ Q2_program,
data=student, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab2, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#If employed
nonbloombergstudentemployed <- sleephygiene %>% filter(Q37_employed == "N/A - I am not a student at Bloomberg")
tab3 <- tableby(~ Q92_notSPHemployed,
data=nonbloombergstudentemployed, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab3, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#If employed and not bloomberg
employed <- nonbloombergstudentemployed %>% filter(Q92_notSPHemployed == "Yes")
tab4 <- tableby(~ Q93_worksetting,
data=employed, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab4, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#wfh not bloomberg
#wfhnotbloomberg <- nonbloombergstudentemployed %>% filter(Q93_worksetting == "I work in a location away from my home")
#tab5 <- tableby(~ Q94_dayornight,
#                data=wfhnotbloomberg, test=TRUE, total=TRUE,
#                numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
#summary(tab5, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#student at bloomberg
studentemployed <- student %>% filter(Q37_employed == "Yes")
tab6 <- tableby(~ Q38_worksetting,
data=studentemployed, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab6, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
studentemployedlocation <- student %>% filter(Q39_dayornight == "I work in a location away from my home")
#tab7 <- tableby(~ Q39_dayornight,
#                data=studentemployedlocation, test=TRUE, total=TRUE,
#                numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
#summary(tab7, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#Aware of how to improve sleep quality
awareofsleepqualityimprovements <- sleephygiene %>% filter(Q84_awareofhowtoimprovesleepquality == "Yes")
tab8 <- tableby(~ Q85_waystoimprovesleepquality,
data=awareofsleepqualityimprovements, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab8, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#Talked to someone
talkedtosomeone <- sleephygiene %>% filter(Q95_talkedtoanyone == "Yes")
tab9 <- tableby(~ Q83_talkedtowho,
data=talkedtosomeone, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab9, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#engaged in any way
engagedwiththecampaign <- sleephygiene %>% filter(Q69_didyouengagewiththecampaign == "Yes")
tab10 <- tableby(~ Q62_howdidyouengage +
Q64_whichtechniquedidyoutry +
Q90_areyouhappywithyoursleepquality_awareofcampaign +
Q75_moving +
Q75_breathing +
Q75_powerdown,
data=engagedwiththecampaign, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab10, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#did not engagee in any way
noengagementwiththecampagin <- sleephygiene %>% filter(Q69_didyouengagewiththecampaign %in% c("No", "Don't know"))
tab11 <- tableby(~ Q91_areyouhappywithyoursleepquality_notawareofcampaign +
Q89_ratesleepquality_notawareofcampaign,
data=noengagementwiththecampagin, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab11, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#not convenient
notconvenient <- sleephygiene %>% filter(Q68_timing == "No")
tab12 <- tableby(~ Q70_timingoftextsinconvenient,
data=noengagementwiththecampagin, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab12, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#tooearlyintheday
tooearlyortoolate <- notconvenient %>% filter(Q70_timingoftextsinconvenient %in% c("Received message too early in the day", "Received message too late in the day"))
tab13 <- tableby(~ Q87_idealtime,
data=tooearlyortoolate, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab13, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#whichmosteducational
instagramortext <- engagedwiththecampaign %>% filter(Q62_howdidyouengage %in% c("Instagram", "Text message campaign"))
#tab14 <- tableby(~ Q71_whichchannelmosteducational +
#                   Q72,
#                data=instagramortext, test=TRUE, total=TRUE,
#                numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
#summary(tab14, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#instagram
instagram <- engagedwiththecampaign %>% filter(Q62_howdidyouengage == "Instagram campaign")
tab15 <- tableby(~ Q74_rafflemotivating,
data=instagram, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab15, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
#seenorheardofthecampiagn
seenordheard <- sleephygiene %>% filter(Q81_seenorheardfromGNbloombergcampaign == "Yes")
tab16 <- tableby(~ Q81_seenorheardfromGNbloombergcampaign,
data=seenordheard, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab16, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
# Chunk 9
sleephygiene <- sleephygiene %>% mutate(Engagementyesno = case_when(
Q69_didyouengagewiththecampaign == "Yes" ~ 1,
Q69_didyouengagewiththecampaign == "No" ~ 0,
Q69_didyouengagewiththecampaign == "Don't know" ~ 0,
is.na(Q69_didyouengagewiththecampaign) ~ NA_real_)) %>%
mutate(Engagementyesno = factor(Engagementyesno))
tab1 <- tableby(Engagementyesno ~ Q3_role +
Q4_gender +
Q5_age +
Q6_numberinhousehold +
Q37_employed +
Q10_hoursofsleeplast5workdays +
Q10_hoursofsleeppastweekend +
Q9_howoftensleepypastmonth +
Q61_howoftensleepypasttwoweeks +
Q84_awareofhowtoimprovesleepquality +
Q81_seenorheardfromGNbloombergcampaign +
Q96_picture1 +
Q96_picture2 +
Q96_picture3 +
Q96_picture4 +
Q96_picture5 +
Q96_picture6 +
Q96_picture7 +
Q96_picture8 +
Q95_talkedtoanyone +
Q82_knowanyonewhoengaged +
Q69_didyouengagewiththecampaign +
Q67_move30minutes +
Q67_breathing +
Q67_powerdown +
Q68_timing +
Q79_moresuccessfuloutcomsuggestions +
Q59_canmaintainhealthysleephabits +
Q59_cancutoutscreen +
Q59_canexercise +
Q59_canparticipateinbreathing +
Q44_goodnightsleepisimportant +
Q44_mentalclarity +
Q44_feelpositive +
Q44_cuttingoutscreenleadstobettersleep +
Q44_exercisingleadstobettersleep +
Q44_breathingexercisesleadstobettersleep +
Q44_iwillstopscreens +
Q44_iwillexercise +
Q44_iwillbreathe,
data=sleephygiene, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab1, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
sleephygienepre <- readRDS(file="foranalysis.rds")
sleephygienepre <- sleephygienepre %>%
mutate(Q5_age = case_when(
Q5_age >= 18 & Q5_age <= 25 ~ "18-25",
Q5_age >= 26 & Q5_age <= 34 ~ "26-34",
Q5_age >= 35 & Q5_age <= 44 ~ "35-44",
Q5_age >= 45 & Q5_age <= 54 ~ "45-54",
Q5_age >= 55 & Q5_age < 64 ~ "55-64",
Q5_age >= 64 & Q5_age <= 75 ~ "64-75",
Q5_age > 75 ~ "75+",
is.na(Q5_age) ~ NA_character_
)) %>%
mutate(Q5_age = factor(Q5_age)) %>%
mutate(post = 0) %>%
mutate(
Q10_hoursofsleeplast5workdays = Q10_workdayhoursofsleep,
Q10_hoursofsleeppastweekend = Q11_weekendhoursofsleep,
Q61_howoftensleepypasttwoweeks = Q9_howoftensleepy
) %>%
select(post, Q3_role, Q2_program, Q4_gender, Q5_age, Q6_numberinhousehold, Q10_hoursofsleeplast5workdays, Q10_hoursofsleeppastweekend, Q61_howoftensleepypasttwoweeks)
sleephygienepost <- sleephygiene %>% mutate(post = 1) %>% select(post, Q3_role, Q2_program, Q4_gender, Q5_age, Q6_numberinhousehold, Q10_hoursofsleeplast5workdays, Q10_hoursofsleeppastweekend, Q61_howoftensleepypasttwoweeks)
sleephygienepreandpost <- rbind(sleephygienepre, sleephygienepost)
sleephygienepreandpost <- sleephygienepreandpost %>% mutate(Q61_smaller = case_when(
is.na(Q61_howoftensleepypasttwoweeks) ~ NA_character_,
Q61_howoftensleepypasttwoweeks == "Never" ~ "Never",
Q61_howoftensleepypasttwoweeks == "Rarely" ~ "Rarely",
Q61_howoftensleepypasttwoweeks == "Sometimes" ~ "Sometimes",
Q61_howoftensleepypasttwoweeks == "Very often" | Q61_howoftensleepypasttwoweeks == "Always" ~ "Very often or Always",
)) %>%
mutate(Q61_smaller = factor(Q61_smaller)) %>%
mutate(Q2_program = case_when(
Q2_program == "Post-doctoral student" ~ "Post doctoral student",
TRUE ~ Q2_program
))
tab1 <- tableby(post ~ Q3_role +
Q2_program +
Q4_gender +
Q5_age +
Q6_numberinhousehold +
Q10_hoursofsleeplast5workdays +
Q10_hoursofsleeppastweekend +
Q61_smaller,
data=sleephygienepreandpost, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
sleephygienepreandpost <- sleephygienepreandpost %>% mutate(Q61_smaller = case_when(
is.na(Q61_howoftensleepypasttwoweeks) ~ NA_character_,
Q61_howoftensleepypasttwoweeks == "Never" ~ "Never",
Q61_howoftensleepypasttwoweeks == "Rarely" ~ "Rarely",
Q61_howoftensleepypasttwoweeks == "Sometimes" ~ "Sometimes",
Q61_howoftensleepypasttwoweeks == "Very often" | Q61_howoftensleepypasttwoweeks == "Always" ~ "Very often or Always",
)) %>%
mutate(Q61_smaller = factor(Q61_smaller)) %>%
mutate(Q2_program = case_when(
Q2_program == "Post-doctoral student" ~ as.character("Post doctoral student"),
TRUE ~ Q2_program
))
sleephygienepreandpost <- sleephygienepreandpost %>% mutate(Q61_smaller = case_when(
is.na(Q61_howoftensleepypasttwoweeks) ~ NA_character_,
Q61_howoftensleepypasttwoweeks == "Never" ~ "Never",
Q61_howoftensleepypasttwoweeks == "Rarely" ~ "Rarely",
Q61_howoftensleepypasttwoweeks == "Sometimes" ~ "Sometimes",
Q61_howoftensleepypasttwoweeks == "Very often" | Q61_howoftensleepypasttwoweeks == "Always" ~ "Very often or Always",
)) %>%
mutate(Q61_smaller = factor(Q61_smaller)) %>%
mutate(Q2_program = case_when(
Q2_program == "Post-doctoral student" ~ as.character("Post doctoral student"),
TRUE ~ as.character(Q2_program)
))
sleephygienepreandpost <- sleephygienepreandpost %>% mutate(Q61_smaller = case_when(
is.na(Q61_howoftensleepypasttwoweeks) ~ NA_character_,
Q61_howoftensleepypasttwoweeks == "Never" ~ "Never",
Q61_howoftensleepypasttwoweeks == "Rarely" ~ "Rarely",
Q61_howoftensleepypasttwoweeks == "Sometimes" ~ "Sometimes",
Q61_howoftensleepypasttwoweeks == "Very often" | Q61_howoftensleepypasttwoweeks == "Always" ~ "Very often or Always",
)) %>%
mutate(Q61_smaller = factor(Q61_smaller)) %>%
mutate(Q2_program = case_when(
Q2_program == "Post-doctoral student" ~ as.character("Post doctoral student"),
TRUE ~ as.character(Q2_program)
)) %>%
mutate(Q2_program = factor(Q2_program))
tab1 <- tableby(post ~ Q3_role +
Q2_program +
Q4_gender +
Q5_age +
Q6_numberinhousehold +
Q10_hoursofsleeplast5workdays +
Q10_hoursofsleeppastweekend +
Q61_smaller,
data=sleephygienepreandpost, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab1, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
tab1 <- tableby(post ~ Q3_role +
Q2_program +
Q4_gender +
Q5_age +
Q6_numberinhousehold +
Q10_hoursofsleeplast5workdays +
Q10_hoursofsleeppastweekend +
Q61_smaller,
data=sleephygienepreandpost, test=TRUE, total=TRUE,
numeric.stats=c("medianq1q3"), numeric.test="kwt", cat.test="chisq")
summary(tab1, title='Table 1. Baseline information', pfootnote=TRUE, digits = 2)
```{r}
library(sjPlot)
sleephygiene <- sleephygiene %>% mutate(Q69_didyouengagewiththecampaignbinary = case_when(
Q69_didyouengagewiththecampaign == "No" ~ 0,
Q69_didyouengagewiththecampaign == "Yes" ~ 1)) %>%
mutate(Q4_gender_binary = case_when(
Q4_gender == "Male" ~ 1,
Q4_gender == "Female" ~ 0,
TRUE ~ NA_real_
)) %>%
mutate(Q4_gender_binary = factor(Q4_gender_binary, labels = c("Female", "Male"))) %>%
mutate(happywithsleepqualitycombined = case_when(
Q90_areyouhappywithyoursleepquality_awareofcampaign == "Yes" ~ 1,
Q90_areyouhappywithyoursleepquality_awareofcampaign == "No" ~ 0,
Q91_areyouhappywithyoursleepquality_notawareofcampaign == "Yes" ~ 1,
Q91_areyouhappywithyoursleepquality_notawareofcampaign == "No" ~ 0,
Q89_ratesleepquality_notawareofcampaign == "Good" ~ 1,
Q89_ratesleepquality_notawareofcampaign == "Excellent" ~ 1,
Q89_ratesleepquality_notawareofcampaign == "Poor" ~ 0,
Q89_ratesleepquality_notawareofcampaign == "Fair" ~ 0,
)) %>%
mutate(happywithsleepqualitycombined = factor(happywithsleepqualitycombined)) %>%
mutate(Q67_1 = case_when(
is.na(Q67_1) ~ 0,
TRUE ~ as.numeric(Q67_1)
)) %>%
mutate(Q67_2 = case_when(
is.na(Q67_2) ~ 0,
TRUE ~ as.numeric(Q67_2)
)) %>%
mutate(Q67_3 = case_when(
is.na(Q67_3) ~ 0,
TRUE ~ as.numeric(Q67_3)
)) %>%
mutate(pointscombinedperdays = Q67_1 + Q67_2 + Q67_3) %>%
mutate(ratesleepqualitycombined = case_when(
Q89_ratesleepquality_notawareofcampaign == "Good" ~ 1,
Q89_ratesleepquality_notawareofcampaign == "Excellent" ~ 1,
Q89_ratesleepquality_notawareofcampaign == "Poor" ~ 0,
Q89_ratesleepquality_notawareofcampaign == "Fair" ~ 0,
))
#Participating in the campaign
mylogit <- glm(Q69_didyouengagewiththecampaignbinary ~ Q4_gender_binary + Q10_hoursofsleeplast5workdays + Q10_hoursofsleeppastweekend, family = binomial(link = "logit"), data = sleephygiene)
tab_model(mylogit)
#Happy with sleep quality
mylogit <- glm(happywithsleepqualitycombined ~ Q4_gender_binary + Q10_hoursofsleeplast5workdays + Q10_hoursofsleeppastweekend + Q69_didyouengagewiththecampaignbinary, family = binomial(link = "logit"), data = sleephygiene)
tab_model(mylogit)
mylogit <- glm(happywithsleepqualitycombined ~ pointscombinedperdays, family = binomial(link = "logit"), data = sleephygiene)
tab_model(mylogit)
#Happy with sleep quality
mylogit <- glm(happywithsleepqualitycombined ~ Q4_gender_binary + Q10_hoursofsleeplast5workdays + Q10_hoursofsleeppastweekend + Q69_didyouengagewiththecampaignbinary, family = binomial(link = "logit"), data = sleephygiene)
tab_model(mylogit)
#Participating in the campaign
mylogit <- glm(Q69_didyouengagewiththecampaignbinary ~ Q4_gender_binary + Q10_hoursofsleeplast5workdays + Q10_hoursofsleeppastweekend, family = binomial(link = "logit"), data = sleephygiene)
tab_model(mylogit)
